---
title: "Advent7"
author: "Mandy Grawl"
date: "2025-12-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
file <- "Advent7.txt"

lines <- readLines(file, warn = FALSE)
maxw <- max(nchar(lines))
mat <- t(sapply(lines, function(l) {
  chars <- strsplit(l, "")[[1]]
  length(chars) <- maxw
  chars[is.na(chars)] <- " "
  chars
}))
nrows <- nrow(mat)
ncols <- ncol(mat)

pos <- which(mat == "S", arr.ind = TRUE)
if (nrow(pos) == 0) stop("No S found in input")
start_row <- pos[1,1]
start_col <- pos[1,2]

rows_q <- integer()
cols_q <- integer()

rows_q <- c(rows_q, start_row + 1)
cols_q <- c(cols_q, start_col)

splits <- 0L
head <- 1L

while (head <= length(rows_q)) {
  r <- rows_q[head]
  c <- cols_q[head]
  head <- head + 1L

  if (is.na(r) || is.na(c) || r > nrows || c < 1 || c > ncols) next

  cell <- mat[r, c]

  if (cell == "^") {
    splits <- splits + 1L
    if (c - 1 >= 1) {
      rows_q <- c(rows_q, r)
      cols_q <- c(cols_q, c - 1)
    }
    if (c + 1 <= ncols) {
      rows_q <- c(rows_q, r)
      cols_q <- c(cols_q, c + 1)
    }
  } else {
    rows_q <- c(rows_q, r + 1L)
    cols_q <- c(cols_q, c)
  }
}

cat(splits, "\n")

```

```{r}
mat <- do.call(rbind, lapply(lines, function(l) {
  chars <- strsplit(l, "")[[1]]
  length(chars) <- maxw
  chars[is.na(chars)] <- " "
  chars
}))
nrows <- nrow(mat)
ncols <- ncol(mat)

pos <- which(mat == "S", arr.ind = TRUE)
if (nrow(pos) == 0) stop("No S found in input")
start_row <- pos[1,1]
start_col <- pos[1,2]

split_rows_by_col <- vector("list", ncols)
for (c in seq_len(ncols)) {
  split_rows_by_col[[c]] <- which(mat[, c] == "^")
}

memo <- new.env(parent = emptyenv())

count_from <- function(r, c) {
  if (c < 1 || c > ncols) return(1.0)
  if (r > nrows) return(1.0)
  key <- paste(r, c, sep = ",")
  if (exists(key, envir = memo, inherits = FALSE)) {
    return(get(key, envir = memo, inherits = FALSE))
  }
  rows <- split_rows_by_col[[c]]
  if (length(rows) == 0) {
    val <- 1.0
    assign(key, val, envir = memo)
    return(val)
  }
  idx <- which(rows >= r)
  if (length(idx) == 0) {
    val <- 1.0
    assign(key, val, envir = memo)
    return(val)
  }
  rsplit <- rows[idx[1]]
  left <- count_from(rsplit, c - 1)
  right <- count_from(rsplit, c + 1)
  val <- left + right
  assign(key, val, envir = memo)
  return(val)
}

result <- count_from(start_row + 1, start_col)

cat(result, "\n")

```


